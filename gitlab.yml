---

- name: Prepare server
  hosts: instance
  gather_facts: no
  tasks:
  - name: Wait 300 seconds for target connection to become reachable/usable
    wait_for:
      host: "{{ ansible_host }}"
      port: 22
      state: started
      delay: 15
      connect_timeout: 5
    delegate_to: localhost


- name: Install Gitlab on server
  hosts: all

  roles:
    - jagoanhosting.gitlab